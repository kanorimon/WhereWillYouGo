
  <script type="text/javascript">
 function initialize() { 
    
    var directionsDisplay = new google.maps.DirectionsRenderer(); //　ルート案内
    var directionsService = new google.maps.DirectionsService(); // 地図表示用

    directionsDisplay.setOptions(
     {
       suppressMarkers: true
     });
 
    //東京駅を中心に地図を表示。 
    var myLatlng = new google.maps.LatLng(<%= @lat_center %>, <%=  @lng_center %>); 
    var options = { 
        //地図のズームサイズ 
        zoom: 15, 
        //地図の中心地 
        center: myLatlng, 
        mapTypeId: google.maps.MapTypeId.ROADMAP 
    }; 
    var map = new google.maps.Map(document.getElementById("map"), options); 

    
    //マーカー表示 
    var myMarker = new google.maps.Marker({
      position: new google.maps.LatLng(<%= @lat_center %> ,<%= @lng_center %>),
      title: "スタート/ゴール",
      map: map,
      icon: new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld="+ ("S") + "|5B7437|000000"),
      shadow: new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_shadow",null,null, new google.maps.Point(12, 35) )
    });

    <% @results.each_with_index do |i,k| %>
    var myMarker = new google.maps.Marker({
      position: new google.maps.LatLng(<%= i['geometry']['location']['lat'] %> ,<%= i['geometry']['location']['lng'] %>),
      title: "<%= i['name'] %>",
      map: map,
      icon: new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld="+ (<%= k+1 %>) + "|FAB951|000000"),
      shadow: new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_shadow",null,null, new google.maps.Point(12, 35) )

    });
    <% end %>


    
    directionsDisplay.setMap(map);
 
    var start = new google.maps.LatLng(<%= @lat_center %> , <%= @lng_center %> );
    var end = new google.maps.LatLng(<%= @lat_center %> , <%= @lng_center %> );
    var request = {
    origin:start, // 出発地
    destination:end, // 目的地
	waypoints:[
    <% @results.each do |i| %>
     	{location:new google.maps.LatLng(<%= i['geometry']['location']['lat'] %> , <%= i['geometry']['location']['lng'] %> )},
    <% end %>
	], //　途中経路
    travelMode: google.maps.DirectionsTravelMode.WALKING // 車で
    };
    directionsService.route(request, function(response, status) {
      if (status == google.maps.DirectionsStatus.OK) {
      directionsDisplay.setDirections(response); // 描画
      }
    });
    
  };
  


    </script>
    
</head>
<body onload="initialize()">
	
		
    <div class="container-narrow">

      <div class="masthead text-center">
        <%= image_tag('asudoko_logo.png') %>
      </div>

      <hr>

      <div class="jumbotron">
        <div id="map" style="width: 700px; height: 400px;"></div> 
      </div>

      <hr>

      <div class="jumbotron">
<table class="table">
  <thead>
    <tr>
      <th>No.</th>
      <th>名前</th>
      <th>住所</th>
    </tr>
  </thead>
  <tbody>
  
<% @results.each_with_index do |i,k| %>
  <% if k%2 == 0 %>
    <tr class="success">
  <% else %>
    <tr class="warning">
  <% end %>
    <td><%= k + 1 %></td>
    <td><%= i['name'] %></td>
    <td><%= i['vicinity'] %></td>
  </tr>
<% end %>
  </tbody>
</table>

<a class="btn btn-large btn-warning" href="<%= root_url(:only_path => false) %>">戻る</a>

      </div>

      <hr>

      <div class="footer">
        <p>&copy; kanorimon 2013</p>
      </div>

    </div> <!-- /container -->